<h1>Background</h1>
This project represents a part of an event-driven pipeline, used to automate the evaluation of the objects uploaded in the Google Cloud Storage, for any malicious code.

The project consists of a REST server implemented with `Jetty`, and an open source antivirus engine called [clamAV](https://www.clamav.net/). Both  the server and clamAV service run in a Docker container hosted in [App Engine flexible environment](https://cloud.google.com/appengine). 

The steps involved can be outlined as follows:


1. Objects are uploaded to the Google cloud storage bucket.

2. The upload event automatically triggers a cloud function, invoking the malware scanner service by calling an endpoint
    (`POST https://project-domain-name/malwarescan/scan`)


3. The malware scanner service scans the object, and returns the scan result.

<h1>Running the project locally</h1>

1. Run `mvn install` from the project root, which will generate a `jar` file inside `target` directory

2. Build the Docker image using `docker build -t malwarescanner .`

3. Run the built image using `docker run -p 8080:8080 -t -i malwarescanner`. The scanner server should now be available at `localhost:8080`. To check the server status, send a `GET` to `localhost:8080/malwarescan`, and to perform the actual scan, send a `POST` to `localhost:8080/malwarescan/scan` with `file` as a payload (using form-data).

<h1>Cloud deployment</h1>

1. Create the service using `gcloud app create --project=$DEVSHELL_PROJECT_ID --region=europe-west1` (at the project root)

2. Deploy it to app engine using `gcloud app deploy`

